import{r as n,j as e,B as d,z as T,L as A,V as B,S as F,H as V}from"./index-BgPfMftx.js";import"./index.es-lcVZeYJ_.js";import{u as q}from"./useClickOutside-CuiuMGrl.js";import{g as O}from"./imageConvert-EpfzBV9D.js";import{I as U}from"./chunk-QINAG4RG-CS9ezQ7p.js";import{S as _}from"./chunk-5PH6ULNP-DzDKoMfl.js";import{T as $}from"./chunk-2OOHT3W5-CJpRdX3-.js";import{S as E}from"./chunk-GOJLRND4-Cwyv9KoW.js";import"./index-Bgli6ANI.js";import"./chunk-DMO4EI7P-ffbJSNvT.js";import"./chunk-R3DH46PF-iWUMGBws.js";const D=({src:s,alt:m,imgWidth:t,auto:i,...f})=>{const l=n.useRef();return n.useEffect(()=>{const c=l.current,h=new IntersectionObserver((b,a)=>{b.forEach(u=>{if(u.isIntersecting){const p=u.target;p.src=O({src:s,imgWidth:t,auto:i}),p.removeAttribute("data-src"),a.unobserve(p)}})},{root:null,rootMargin:"200px 0px",threshold:0});return c&&h.observe(c),()=>{c&&h.unobserve(c)}},[s,t,i]),e.jsx(e.Fragment,{children:e.jsx(U,{ref:l,"data-src":O({src:s,imgWidth:t,auto:i}),alt:m,...f})})},G=({category:s,setMenu:m,menu:t,marginLeft:i})=>e.jsx(d,{alignSelf:"start",marginLeft:i,width:"100%",_hover:{color:"#da1a32"},textStyle:"StyledNav",children:s}),J=s=>{let m=!1;return()=>{m||(m=!0,window.requestAnimationFrame(()=>{s(),m=!1}))}},K=({scrollerRef:s,invisiblePartHeight:m=0,itemHeight:t=200,itemBorder:i=0,itemMarginBottom:f=0,eachColCount:l=1,initialShowColNum:c=3,preloadingColNum:h=1})=>{const[b,a]=n.useState({start:0,end:c*l}),u=i.split(" ").find(g=>g.includes("px")),p=parseInt(u),S=t+p*2+f,j=n.useCallback(()=>{if(s.current){const g=s.current.getBoundingClientRect(),y=window.innerHeight,x=(g.top-m)*-1,R=x+y-m,r=Math.max(0,(Math.floor(Math.abs(x)/S)-h)*l),H=(Math.floor(R/S)+1+h)*l;a({start:r,end:H})}},[s,m,S,l,h]);return n.useEffect(()=>{const g=J(j);return window.addEventListener("scroll",g),window.addEventListener("resize",g),()=>{window.removeEventListener("scroll",g),window.removeEventListener("resize",g)}},[j]),b},Q=({scrollHeight:s,backgroundColor:m="#ffffff",elements:t,range:i,scrollerRef:f,height:l=200,border:c="",marginRight:h=0,marginBottom:b=0,eachColCount:a=1})=>{const u=n.useRef(null),[p,S]=n.useState(0),j=n.useMemo(()=>(p-h*(a-1))/a,[p,h,a]);return n.useEffect(()=>{const g=()=>{u.current&&S(u.current.offsetWidth)};return g(),window.addEventListener("resize",g),()=>{window.removeEventListener("resize",g)}},[]),e.jsx(d,{position:"relative",id:"scroller",height:s,backgroundColor:m,ref:f,children:e.jsx(d,{ref:u,children:t.slice(i.start,i.end).map((g,y)=>{const x=i.start+y;return e.jsx(d,{id:`item${x+1}`,width:j,border:c,position:"absolute",height:l,marginBottom:b,transform:a!==1?`translate(${Math.floor(x%a)*j+Math.floor(x%a)*(p-j*a)/(a-1)}px,
                            ${Math.floor(x/a)*l+Math.floor(x/a)*(b+2)}px)`:`translate(0px,
                            ${Math.floor(x/a)*l+Math.floor(x/a)*(b+2)}px)`,children:g},x)})})})},W=(s,m)=>{const t=()=>{const l=window.innerWidth,c=Object.keys(s);for(let h=c.length-1;h>=0;h--)if(l>=s[c[h]])return c[h];return"base"},[i,f]=n.useState(t);return n.useEffect(()=>{const l=()=>{const c=t();c!==i&&f(c)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[s,i]),m[i]},X=()=>{const[s,m]=n.useState(!1),[t,i]=n.useState({category:[],data:[]}),[f,l]=n.useState(1),[c,h]=n.useState(!1),[b,a]=n.useState(!0),u=T(),p=n.useRef(null),S=n.useRef(),[j,g]=n.useState(!1);n.useEffect(()=>{(async()=>{h(!0);const v=new URLSearchParams(u.search).get("category"),L=20;v&&a(!1);try{let k;v?k=await fetch(`http://localhost:5000/api/order?category=${v}`):k=await fetch(`http://localhost:5000/api/api?page=${f}&limit=${L}`);const M=await k.json();M.data.length===0&&a(!1),i(v?{category:M.category,data:M.data}:z=>({category:f===1?M.category:z.category,data:f===1?M.data:[...z.data,...M.data]}))}catch(k){console.log(k)}finally{h(!1)}})()},[u.search,u,f]),n.useEffect(()=>{const o=new IntersectionObserver(v=>{v[0].isIntersecting&&!c&&l(L=>L+1)},{root:null,rootMargin:"0px",threshold:1}),w=document.getElementById("sentinel");return w&&o.observe(w),()=>{w&&o.unobserve(w)}},[c]);const y=n.useMemo(()=>t.data.length>0?Object.values(t.data||[]).map((o,w)=>e.jsx(A,{to:`/order2/${o.strMeal}`,width:"100%",children:e.jsxs(B,{_hover:{img:{opacity:.7},p:{color:"#da1a32"}},width:"100%",children:[e.jsx(D,{src:o.strMealThumb,alt:o.strMeal,width:"100%",imgWidth:"250",auto:"webp",height:"250px",objectFit:"cover"}),e.jsxs(d,{padding:"0.5rem 1rem .75rem",children:[e.jsx($,{textStyle:"StyledText",color:"#333333",align:"center",marginBottom:"0.625rem",fontSize:{xxl:"20px",base:"18px"},children:o.strMeal}),e.jsx(d,{children:e.jsxs($,{textStyle:"StyledText",color:"#333333",align:"end",marginRight:"1rem",fontSize:{xxl:"20px",base:"18px"},children:["Price: $",o.price]})})]})]},o.idMeal)})):[...Array(20)].map((o,w)=>e.jsxs(e.Fragment,{children:[e.jsx(E,{height:"250px",width:"100%"},w),e.jsxs(d,{padding:"0.5rem 1rem .75rem",children:[e.jsx(E,{height:{xxl:"20px",base:"18px"},width:"100%",marginBottom:"0.625rem"},w),e.jsx(E,{height:{xxl:"20px",base:"18px"},width:"100%",marginRight:"1rem"},w)]})]})),[t.data]),x=W({xs:400,sm:576,md:768,lg:992,xl:1200,xxl:1400},{xxl:4,xl:4,lg:4,md:3,sm:2,xs:2,base:1}),R=W({xs:400,sm:576,md:768,lg:992,xl:1200,xxl:1400},{base:380,xs:380,sm:360,md:360,lg:430,xl:420,xxl:415}),r=n.useMemo(()=>({invisiblePartHeight:90,itemHeight:R,marginRight:5,marginBottom:30,itemBorder:"1px solid #e4e4e4",backgroundColor:"#fbdabb4d",initialShowColNum:3,eachColCount:x,preloadingColNum:1,elements:y}),[x,y,R]),H=r.itemBorder.split(" ").find(o=>o.includes("px")),I=parseInt(H),C=(t.data.length===0?20:t.data.length)%r.eachColCount===0?Math.floor((t.data.length===0?20:t.data.length)/r.eachColCount)*r.itemHeight+Math.floor((t.data.length===0?20:t.data.length)/r.eachColCount-1)*(r.marginBottom+I*2)+"px":Math.floor((t.data.length===0?20:t.data.length)/r.eachColCount+1)*r.itemHeight+Math.floor((t.data.length===0?20:t.data.length)/r.eachColCount)*(r.marginBottom+I*2)+"px";console.log(C);const N=K({scrollerRef:p,invisiblePartHeight:r.invisiblePartHeight,itemHeight:r.itemHeight,itemBorder:r.itemBorder,itemMarginBottom:r.marginBottom,initialShowColNum:r.initialShowColNum,eachColCount:r.eachColCount,preloadingColNum:r.preloadingColNum}),P=o=>{const w=o?`/order2?category=${o}`:"/order2";l(1),i({category:[],data:[]}),window.history.pushState(null,"",w),a(!o)};if(q(S,()=>{g(!1)}),Object.keys(t.data).length>0||c)return e.jsx(B,{children:e.jsxs(F,{minHeight:"auto",width:"100%",justifyContent:"space-between",direction:{lg:"row",base:"column"},children:[e.jsxs(d,{width:{lg:"30%",base:"100%"},backgroundColor:"#fbdabb4d",height:"fit-content",padding:"0 0 3vh 3vh",children:[e.jsx(d,{textStyle:"StyledNav",fontSize:"2em",onClick:()=>m(!s),children:"Ingredient"}),e.jsx(B,{display:s?"flex":"none",marginLeft:"0",children:Object.values(t.category||[]).map(o=>e.jsx(G,{category:o,setMenu:i,menu:t,marginLeft:"3vh",onClick:()=>P(o)},o))})]}),e.jsxs(F,{width:{lg:"70%",base:"100%"},children:[e.jsxs(V,{id:"filterContainer",justifyContent:"space-between",children:[e.jsx(d,{as:"h1",textStyle:"StyledH1",color:"black",id:"currentResults",children:"Menu page"}),e.jsxs(d,{children:[e.jsx(d,{id:"sortResults",ref:S,onClick:()=>g(!j),children:"Sort By"}),j&&e.jsx(d,{position:"absolute",backgroundColor:"#FFFFFF",zIndex:"50",right:"0",minWidth:"150px",height:"auto",border:"1px solid #ccc",children:e.jsxs(B,{position:"relative",children:[e.jsx(d,{children:"Relevance"}),e.jsx(d,{children:"Price (Low to High)"}),e.jsx(d,{children:"Price (High to Low)"})]})})]})]}),e.jsx(Q,{scrollHeight:C,elements:y,range:N,scrollerRef:p,backgroundColor:r.backgroundColor,height:r.itemHeight,border:r.itemBorder,marginRight:r.marginRight,marginBottom:r.marginBottom,eachColCount:r.eachColCount}),b&&e.jsx(d,{id:"sentinel",height:"1px",width:"100%",children:e.jsx(d,{width:"fit-content",margin:"auto",children:e.jsx(_,{size:"xl"})})})]})]})})},Y=()=>e.jsx(n.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx(B,{w:"100%",align:"start",padding:"10vh 0",id:"menu",children:e.jsx(d,{position:"relative",width:"100%",children:e.jsx(X,{})})})});export{Y as default};
